<!doctype html>
<html>

<head>
    <link rel="stylesheet" href="node_modules/@xterm/xterm/css/xterm.css" />
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.7/dist/axios.min.js"></script>
    <script src="node_modules/@xterm/xterm/lib/xterm.js"></script>
</head>

<body>
    <div id="terminal"></div>
    <script>
        document.onkeydown = function (e) {
            e = e || window.event;//Get event

            if (!e.ctrlKey) return;

            var code = e.which || e.keyCode;//Get key code
            e.preventDefault();
            e.stopPropagation();
        };
        var term = new Terminal({
            cursorStyle: 'bar',  // 默认为块状光标
            allowTransparency: true,
            cursorBlink: false,
            cursorWidth: 4,
            minimumContrastRatio:1,
            // theme: {
            //     selection: "#888"
            // }
        });

        // term.on('key', function (key, e) {
        //     axios.get('/key').then(function (response) {

        //     })
        // });
        term.onKey(function (a) {
            console.log(a)
            axios.post('/key', {
                key: a.key
            }).then(function (response) {

            })
        })
        term.open(document.getElementById('terminal'));
        term.write('Hello from \x1B[1;3;31mxterm.js\x1B[0m $ ')
        const get_term = function () {
            axios.get('/term').then(function (response) {
                term.write(response.data);
                get_term();
            })
        };
        get_term();
    </script>
</body>

</html>